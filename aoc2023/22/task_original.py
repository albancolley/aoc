"""
AOC Day 10
"""
import sys
from common import AocBase
from common import configure
from collections import defaultdict

class Aoc2023010(AocBase):
    """
    AOC Day 10 Class
    """

    def intersect(self, old_rect, new_rect):

        intersect = True
        for i in range(3):
            c1 = old_rect[0][i]
            c2 = old_rect[1][i]
            d1 = new_rect[0][i]
            d2 = new_rect[1][i]

            c_max = max(c1, c2)
            c_min = min(c1, c2)
            d_max = max(d1, d2)
            d_min = min(d1, d2)

            intersect = intersect and c_max >= d_min and c_min <= d_max
            if not intersect:
                return False

        return intersect

    def calc_1(self, data: dict) -> int:
        intersections_down, intersections_up = self.stack_bricks(data)

        # print(len(stack))
        # print(stack)
        #
        # for rect in stack:
        #     print(rect)
        #
        # intersections_up = {403: [944], 1324: [1299], 1230: [380], 369: [380, 1060], 359: [454], 1308: [454], 705: [454], 417: [723], 1113: [1311, 711, 412, 1292], 1163: [1466], 1299: [358], 771: [711], 1060: [1403], 358: [407], 723: [708], 944: [956], 407: [233, 250, 929], 711: [772, 1096, 311], 454: [1099], 380: [1395], 412: [1435, 311], 233: [338, 104], 1435: [479], 708: [753, 729], 1099: [919, 341], 1395: [1087], 1403: [1114], 956: [1224], 479: [172, 325], 597: [232], 1114: [266], 1311: [311], 1087: [1029, 439], 753: [1245], 929: [867], 1029: [867], 1224: [1176, 354], 311: [40, 79, 789], 1096: [1252], 232: [327, 339], 1176: [813], 729: [902], 172: [923], 772: [36], 1252: [154], 354: [492, 170, 173], 327: [1364], 439: [46], 40: [212, 1343], 79: [248], 339: [733], 867: [954, 185, 3], 492: [1204], 36: [209, 960, 291], 170: [319], 248: [357, 602, 1320], 923: [581], 1364: [1000], 212: [548], 954: [998, 130], 209: [1048, 131], 46: [185, 3], 960: [987], 602: [3], 185: [989], 1000: [1011], 998: [1196, 1275, 1408], 987: [1314], 3: [130, 256], 1320: [195], 1314: [440, 475], 1011: [592, 880], 291: [1168], 1048: [1336], 1336: [475], 130: [948, 1420], 1275: [1319, 1026], 592: [16, 673], 1196: [97], 1319: [97, 906], 1420: [246], 880: [1383, 406], 989: [1408], 256: [1408], 246: [346], 440: [1056], 673: [32, 918, 1366], 1408: [77], 475: [461], 406: [461], 16: [959], 948: [1116], 1056: [1240], 1366: [124, 10], 959: [649, 742], 1240: [799, 1338], 1116: [961], 1383: [1436], 1026: [1446], 918: [10], 97: [1078], 906: [1078, 978], 1436: [1278, 703], 799: [103], 124: [207, 1227], 649: [207], 10: [207], 1078: [453, 570], 1338: [526, 747], 742: [631], 1278: [752, 238], 1446: [978], 752: [718], 77: [879], 747: [974, 1264], 703: [1227], 718: [424], 453: [444], 978: [570], 526: [1264], 961: [11], 1227: [85, 267], 631: [111], 879: [894], 207: [1052], 1264: [1155, 701], 424: [198], 974: [812, 930, 1467], 11: [1360, 1460], 267: [667, 783], 1052: [667, 337], 1467: [675], 701: [833], 894: [865, 402], 1155: [871], 570: [942], 111: [1007], 85: [94], 667: [941], 1007: [941], 675: [1030], 930: [768], 198: [1036], 783: [61], 871: [810, 1247], 402: [1216], 337: [1306, 505], 941: [1361, 1365], 1306: [344, 531], 1216: [816, 395, 907], 1361: [821, 1262], 768: [1121], 821: [1068], 1247: [1127, 1146], 1460: [1349], 816: [843], 907: [1044], 1127: [1312], 1068: [66], 843: [606, 537, 1198, 549], 1312: [935, 994], 1349: [281], 1365: [1262], 531: [1262], 1198: [398], 994: [1187], 66: [55, 1049], 1187: [300], 281: [481, 775], 606: [634, 682], 1262: [634], 1146: [825], 1049: [139, 420], 634: [314, 898], 549: [607, 1382], 682: [59], 898: [640, 1309, 1400], 481: [985], 775: [734], 139: [888], 1382: [1244], 314: [1304], 55: [1377], 888: [177], 1304: [270, 1212], 1244: [305], 59: [1309], 305: [463, 4, 127], 177: [1469, 873], 1309: [483, 1286], 734: [709], 1400: [4], 1469: [778, 1246], 463: [1444], 778: [190, 330], 1246: [190, 330], 709: [437, 628], 873: [884], 1286: [1058], 127: [529], 270: [603], 437: [1147, 1485], 1147: [80, 1380], 4: [317], 1485: [870, 1132], 1058: [304], 870: [910], 330: [258, 99], 317: [414], 80: [583, 1110], 529: [661], 190: [99], 1132: [293, 966], 910: [692, 219], 661: [1427, 719], 692: [68, 1067, 656], 99: [255, 1373], 304: [502], 293: [970, 1287, 1342], 1427: [1074], 583: [1169], 68: [93, 955], 255: [485], 258: [651, 915], 970: [950, 75, 191], 1380: [966], 502: [149, 1387], 1342: [191, 656], 1074: [397], 1169: [859, 1182, 1471], 1110: [117], 1287: [450], 1182: [472, 1406, 193, 760, 1455], 1067: [666], 955: [1375], 191: [128], 472: [513, 1105], 1406: [513], 859: [1043], 397: [306], 1471: [710], 450: [1352], 1387: [1410], 1455: [489], 117: [800], 193: [984, 174], 710: [105], 656: [348, 806], 485: [363], 1105: [363, 379], 800: [411], 128: [848], 513: [1184], 306: [749], 1352: [1145], 411: [310], 1375: [486], 1043: [669], 984: [1014], 379: [1027, 488], 806: [60], 105: [202], 174: [376], 749: [914], 666: [1340], 202: [241], 310: [547, 968], 486: [614, 1150], 1340: [72, 1303], 1014: [429], 547: [1473], 914: [636], 429: [726, 784, 50], 1027: [784], 72: [951], 241: [361], 636: [1253, 1249], 361: [214], 1473: [431], 50: [795, 969], 726: [1061], 1303: [1148], 784: [1236, 1439], 951: [462, 613, 962], 431: [750], 1439: [1206], 795: [835, 1086, 435], 969: [835, 514, 986], 962: [1203, 49], 1148: [49], 462: [49], 1206: [321], 1249: [740], 968: [986], 1203: [1088], 613: [1327], 1086: [1376], 1327: [521, 946, 1115], 321: [1441], 435: [1450], 521: [179], 946: [288], 986: [982], 179: [200, 275], 1450: [743], 1441: [785, 1345], 288: [316], 200: [730, 1449, 1041], 750: [1345], 743: [1372, 1457], 982: [1458], 1372: [1120, 1130], 316: [1141], 1458: [446], 1120: [844], 1457: [345, 992, 573], 446: [425], 1449: [552, 933], 1041: [646], 730: [1193], 844: [442], 1141: [868], 275: [1231], 1231: [261, 797, 1118], 573: [560], 868: [905, 73, 1089], 552: [1152], 442: [1310], 425: [1417, 292], 345: [13], 992: [13, 1032], 933: [289], 1152: [882, 1135, 523], 1130: [1032], 13: [164, 943], 1118: [332, 1478], 1032: [1017], 1310: [517, 676], 1417: [841, 1468], 560: [1040], 517: [203, 555], 841: [588], 1089: [808], 882: [1195], 1478: [307, 126], 676: [555], 808: [757], 1135: [774, 1143], 73: [1140], 943: [1484], 1140: [144], 774: [741], 203: [988], 1143: [988], 1484: [1144], 1468: [1476], 757: [296], 741: [625, 1282, 1428], 1476: [1004, 1124], 144: [1136, 262], 296: [756, 542], 756: [54], 988: [368], 1004: [1288, 594, 1139], 1428: [1355, 510], 1124: [1451, 1293], 594: [175], 368: [224, 162], 262: [542], 1139: [1208], 307: [143], 126: [247], 542: [1051, 52], 1293: [1160], 625: [52], 247: [487, 1315], 224: [593, 759], 162: [593, 759], 510: [908, 731], 1208: [194], 143: [518, 1122], 52: [557, 995], 175: [589, 1093], 1355: [731], 557: [362], 1051: [1037], 487: [1328], 518: [1402], 1328: [223, 1481], 593: [1082, 1363], 995: [1137], 1137: [572, 1251], 1402: [714, 89], 1082: [804], 1122: [1434], 1251: [1220, 260], 223: [158], 714: [605], 260: [509, 543], 1220: [519], 158: [769, 136, 976], 519: [556], 543: [556, 1416, 1248], 605: [598, 600], 598: [184, 1018], 509: [1335], 1335: [86, 641, 541], 1416: [1202], 184: [188, 551, 1300], 136: [410, 1386, 383], 976: [23], 188: [137], 86: [323, 1003], 556: [541], 1386: [665], 1248: [685], 551: [1066, 1289, 1154], 1018: [1300], 685: [331, 878, 687], 1300: [671], 410: [773, 1418, 1200], 773: [229, 141], 137: [274], 383: [539], 323: [927], 1066: [1090, 1109], 1289: [971], 23: [1200], 331: [1223], 878: [1228], 671: [582], 1109: [619, 790], 927: [693], 274: [838], 687: [1166], 971: [225, 707], 1223: [793, 497], 141: [1331], 838: [1432], 1166: [45, 591], 1228: [580], 693: [852], 1432: [891], 1331: [48], 891: [343, 254], 582: [469], 497: [654, 478], 45: [765, 1283], 225: [64, 239], 793: [478], 852: [535], 1154: [681, 1437], 1090: [707], 64: [204, 754], 1437: [926], 1283: [1285], 765: [100], 591: [205], 343: [724], 681: [811, 151, 790], 654: [1054], 204: [1413], 478: [216, 1385], 724: [1374], 1385: [283, 832], 1285: [829], 811: [1175], 790: [1339], 151: [269], 254: [459], 1054: [832], 239: [876, 1117, 751], 1413: [896], 829: [736], 283: [751], 1117: [273], 736: [352, 377, 664, 678], 273: [721, 911], 751: [156, 761, 1350], 377: [712], 664: [862], 156: [1267], 721: [1281, 847], 1281: [527], 678: [632], 1267: [782, 997], 911: [1133, 297], 782: [584, 596], 1133: [1102, 494], 632: [567, 1104], 847: [620], 596: [901, 1194], 862: [1123], 567: [360], 997: [562], 360: [231, 779], 297: [349], 1123: [668], 901: [856], 527: [18], 856: [645, 1111], 1104: [670], 620: [1094], 562: [63, 421], 645: [1046, 1055], 779: [1465], 668: [617], 494: [766], 349: [766], 1094: [802, 1229, 33], 231: [958], 1111: [1019], 421: [370, 837], 617: [370], 1465: [388], 18: [980], 1229: [171, 180, 644], 33: [180, 294], 370: [196, 1233], 63: [1259], 171: [44], 180: [44, 118], 388: [853], 980: [999, 633, 776], 766: [1016], 958: [1103], 644: [78, 1260], 802: [294], 196: [387, 1215], 837: [1008, 1035], 78: [15, 426], 1260: [15, 152], 853: [150], 1259: [1035], 1233: [1215], 44: [211], 1008: [457], 1035: [457, 415], 15: [1047], 152: [1047, 1129, 623], 1103: [1295], 294: [67], 457: [67], 1047: [1258], 633: [30], 1129: [371], 1215: [385], 211: [657], 150: [684], 999: [235], 415: [586, 916, 917], 684: [663], 657: [866, 1384], 1258: [809, 24], 1384: [809], 809: [496, 1430], 235: [921, 1072], 371: [24], 866: [302, 1077], 586: [328], 916: [554, 776], 921: [1367, 1472], 663: [1369], 554: [599, 1261], 1077: [803, 1108], 328: [1197], 1369: [1241], 1197: [186, 854], 803: [257, 1177], 1072: [550], 1108: [568], 776: [860, 972], 302: [965, 642], 599: [1210], 1472: [1332], 550: [65, 1370], 972: [356, 715], 1430: [1119, 237], 496: [237], 965: [237, 1177, 1423], 257: [320], 356: [393], 320: [227], 1332: [409, 1183], 642: [1423], 186: [1479], 715: [647], 65: [720], 1423: [886, 558], 237: [1059], 1261: [1353], 24: [264], 393: [264], 1370: [1107, 301], 1059: [1225, 438], 1183: [206, 280], 264: [828, 69], 1367: [324], 1353: [840], 324: [95], 828: [558, 1344], 720: [706], 706: [842, 611, 1015], 95: [936, 351], 1107: [977], 301: [977], 69: [1344, 725], 280: [1422], 977: [375, 53], 438: [1483], 1015: [378, 1131], 1422: [545], 842: [585], 568: [725], 558: [1033], 1344: [1033, 575], 611: [218], 545: [571], 351: [875, 622, 1270], 936: [1238], 1033: [694], 694: [303, 786, 271], 1238: [587, 1256], 378: [1174], 1131: [1394], 622: [1447, 1106], 218: [87], 875: [635], 375: [745, 1429], 587: [912, 805], 1256: [912, 805], 53: [37], 1394: [449, 1221], 1429: [525], 1174: [827], 1270: [1277], 1106: [1279], 635: [322, 579], 449: [728, 932], 87: [1265], 1279: [1390], 912: [1438], 1221: [110, 1445], 37: [243], 322: [851], 1390: [967], 728: [1294], 967: [41], 932: [165], 1447: [677], 1277: [677], 1265: [1326], 805: [1421], 110: [251, 993], 1326: [430, 1042], 851: [533], 1421: [1101, 1156, 1232], 1438: [1156], 1294: [1482], 1482: [522, 1290], 41: [796], 677: [1271], 1290: [20], 522: [163], 1042: [372, 963], 533: [626], 1271: [781], 243: [1031], 20: [441], 1232: [508], 626: [520, 155], 1031: [928, 1081], 372: [629, 1097], 1097: [389, 1452, 858], 963: [883], 796: [1149], 993: [1191, 495], 883: [452, 1219], 155: [326], 1191: [1189, 1207], 452: [1209], 858: [1214, 716], 1209: [157, 467], 495: [1323, 1207], 157: [315], 716: [386, 904], 467: [443], 1323: [1243], 1214: [1371], 1243: [423, 249, 953], 443: [1409, 215], 1371: [1462, 1307], 423: [1222, 937], 386: [226], 904: [226], 315: [732], 1409: [1396], 953: [1337, 268, 937], 249: [57, 268], 1222: [445], 215: [569], 226: [934], 1396: [1442], 934: [71, 187], 268: [624], 1462: [655], 1337: [849], 937: [849, 1280], 1442: [70, 499, 1456], 1280: [115], 569: [392], 71: [1162, 58, 1333], 849: [1254, 96], 624: [1459], 1459: [1217], 392: [1356], 1162: [201, 1474], 70: [335], 445: [1333], 187: [113, 1161], 115: [512], 1356: [818], 1217: [98], 1456: [448, 767], 818: [691], 201: [855], 767: [134, 408, 688], 113: [236, 680], 98: [350, 748], 691: [1297, 1022], 335: [1412, 408], 1333: [1474], 448: [464], 350: [780], 1474: [1362], 96: [1397], 1397: [182, 890], 1362: [604], 1161: [680], 499: [688], 464: [1028, 210], 680: [47, 221], 688: [355], 855: [1020], 1022: [1321], 780: [590], 47: [381], 890: [698], 604: [1021], 1412: [1173], 1021: [949, 220], 210: [1172, 192], 1173: [19], 381: [26], 1172: [109, 1453], 221: [465, 160], 698: [491, 528], 1028: [192], 26: [1159], 528: [538, 1153], 19: [1005], 160: [142, 830, 197], 1005: [794, 1050], 949: [1071], 538: [1071, 903], 491: [1237], 794: [119, 35], 1237: [419, 643], 1159: [621], 419: [777], 1153: [903], 830: [1211], 119: [34], 777: [168], 197: [574, 846], 1050: [1002], 109: [138], 1453: [138], 1211: [365, 1045, 1341], 846: [679, 1170], 34: [1213], 35: [1242, 897], 1071: [1443], 903: [1443, 947], 643: [2], 192: [287], 1213: [559], 465: [1341], 1045: [8], 287: [500, 367], 1443: [881, 819], 168: [909], 365: [166, 850], 897: [451], 1341: [850], 1242: [957, 1010], 1002: [1076], 574: [1305], 451: [230], 957: [230, 639], 1010: [230, 473, 1433], 679: [864], 166: [924], 1170: [947], 850: [1346], 230: [990, 199], 367: [1291], 864: [1291, 704], 909: [208], 1305: [208], 639: [199, 336], 473: [259, 610], 208: [374, 524], 1291: [506, 877], 506: [108, 1226], 819: [1358], 374: [83], 199: [416], 877: [498], 610: [975], 336: [1083], 1358: [1454], 1226: [738], 975: [1075, 347], 416: [240], 498: [845, 770], 1083: [931, 940], 1075: [1134, 12], 738: [653, 1073], 1454: [889], 259: [1463], 931: [353, 530, 1257], 1433: [456], 240: [1257], 770: [1401], 353: [418], 530: [822], 1257: [1178], 1401: [544], 822: [1359], 1134: [683], 347: [1389, 576], 1178: [178], 1359: [532, 861], 544: [823], 1389: [1171], 1171: [146, 561, 1188], 823: [1440], 178: [25, 1100], 532: [43, 534, 735], 25: [167, 474], 1440: [1053, 1405], 43: [1388, 515, 981], 146: [28], 1388: [615, 618], 861: [618], 1053: [737], 1100: [807], 167: [939], 534: [1302], 515: [1065], 737: [213], 1302: [717, 1348], 474: [1426], 618: [1477], 1348: [470], 717: [762, 382], 470: [1057, 1199, 1354], 1354: [42, 340], 382: [820, 1164], 1057: [857], 1199: [857], 42: [1284], 857: [81], 1164: [503], 820: [689], 340: [1296], 1284: [1351], 81: [1062], 1296: [727], 689: [1391], 727: [504], 1351: [601], 1062: [6], 601: [242, 401, 887], 504: [366, 869, 390, 1273], 6: [477, 952], 366: [648, 120], 869: [74], 390: [74], 1273: [536], 887: [945], 242: [405], 74: [892], 536: [892, 458], 648: [1329], 405: [895, 399, 1218], 945: [1480], 895: [31, 609], 1329: [540], 31: [298, 979, 1411], 1480: [466], 458: [308, 920], 399: [1128], 540: [1415], 466: [313], 298: [1190], 609: [1192, 1411], 1415: [1334], 313: [364, 1085], 920: [964], 979: [744], 364: [1125], 1125: [1157, 577], 964: [1234], 744: [396], 1085: [652], 652: [228, 422], 396: [295], 1234: [318], 1157: [480], 228: [899], 577: [253, 1185], 480: [1092, 1024], 899: [1357, 839], 422: [1393, 14], 318: [1475], 1092: [5], 839: [1012, 627], 1012: [148], 1475: [566, 183, 1276], 1357: [1006], 253: [1001], 1024: [1084], 295: [1276], 5: [1317, 490], 1084: [252, 413, 672], 1317: [1425, 922], 1425: [129], 1276: [169, 814, 1392], 148: [697], 183: [699], 566: [814], 814: [112, 121], 1006: [686], 129: [1112, 893, 1399], 699: [39], 686: [133, 563], 121: [189], 252: [299], 697: [1201], 112: [285, 400], 39: [342], 1392: [627], 893: [1313], 133: [637, 22], 299: [834], 1112: [1080], 285: [1381], 342: [1381], 413: [658], 672: [658], 490: [658, 922], 563: [1180], 1201: [1186, 511], 189: [1404, 1158], 627: [501], 922: [427], 834: [826, 1179, 493, 546], 637: [1431, 722], 22: [1431, 511, 722], 658: [1151], 501: [1158], 1179: [1347], 1431: [140, 787], 722: [436, 1322], 1151: [764, 913], 427: [1038], 1399: [700], 826: [817], 1347: [1098, 1461], 764: [1301], 1098: [9, 391], 1461: [9, 746], 511: [147], 787: [630], 817: [874], 630: [92, 460], 913: [284], 1038: [507], 700: [564], 1186: [27], 1301: [476], 564: [900], 147: [991], 507: [181], 27: [432, 62], 284: [433], 9: [468], 991: [125, 746], 468: [277], 546: [659], 432: [885], 92: [17], 476: [76], 493: [702], 391: [938, 1255], 900: [1266], 181: [1470], 1266: [695, 1325], 885: [983], 695: [1025, 265], 62: [102], 983: [114, 290, 1330], 1325: [265, 863], 702: [404], 17: [434], 1470: [788], 1025: [116, 608], 434: [1167], 114: [282, 334, 159], 290: [334, 447, 739], 1167: [428], 116: [484], 788: [565], 277: [1023], 404: [1239], 428: [925], 1239: [1009], 484: [1142, 107], 863: [1165, 286], 1023: [1378, 815], 608: [90], 1330: [792], 565: [1181], 1378: [29, 312], 1181: [516, 286], 282: [553], 90: [616, 831], 1009: [1039], 159: [1448], 1039: [161, 1398], 792: [373, 836], 107: [455], 616: [1250, 279], 29: [82, 662], 739: [132], 831: [279], 1448: [312], 373: [1126], 836: [234], 312: [384, 1079, 1138], 815: [660, 1070], 1250: [1235], 553: [1379], 1070: [145, 650], 384: [791], 1079: [973], 1235: [1419], 279: [1464], 973: [1407, 1368, 1063], 1464: [690, 135], 234: [798], 662: [801], 1419: [1069], 798: [51, 122], 650: [333, 278], 122: [1272, 38], 690: [1298], 1069: [1318], 1298: [713], 51: [996], 278: [1414, 1263], 1414: [7], 1318: [1274, 674], 38: [176], 1272: [276], 276: [56], 176: [471, 329, 1013], 1263: [1316], 56: [272, 263], 1274: [1095], 1316: [84, 755], 329: [106, 1064], 674: [1091], 84: [21], 106: [88], 263: [824], 1064: [244, 153], 88: [123], 244: [1269, 758], 123: [245], 21: [578], 1269: [872], 153: [1034], 872: [763, 482], 763: [1268], 1268: [222, 394], 222: [595, 696], 394: [595, 696], 595: [1]}
        # intersections_down = {944: [403], 1299: [1324], 380: [1230, 369], 454: [359, 1308, 705], 723: [417], 1060: [369], 1311: [1113], 1466: [1163], 358: [1299], 711: [771, 1113], 1403: [1060], 407: [358], 412: [1113], 708: [723], 956: [944], 1292: [1113], 233: [407], 772: [711], 1099: [454], 1395: [380], 1435: [412], 250: [407], 338: [233], 479: [1435], 753: [708], 919: [1099], 1087: [1395], 1096: [711], 1114: [1403], 1224: [956], 104: [233], 172: [479], 232: [597], 266: [1114], 311: [1311, 711, 412], 341: [1099], 729: [708], 929: [407], 1029: [1087], 1245: [753], 867: [929, 1029], 1176: [1224], 40: [311], 325: [479], 354: [1224], 439: [1087], 1252: [1096], 79: [311], 327: [232], 339: [232], 789: [311], 813: [1176], 902: [729], 923: [172], 36: [772], 154: [1252], 492: [354], 1364: [327], 46: [439], 170: [354], 173: [354], 212: [40], 248: [79], 733: [339], 954: [867], 1204: [492], 1343: [40], 209: [36], 319: [170], 357: [248], 581: [923], 1000: [1364], 548: [212], 960: [36], 998: [954], 1048: [209], 131: [209], 185: [867, 46], 291: [36], 602: [248], 987: [960], 1320: [248], 3: [867, 46, 602], 989: [185], 1011: [1000], 1196: [998], 1275: [998], 1314: [987], 130: [954, 3], 195: [1320], 440: [1314], 592: [1011], 1168: [291], 1336: [1048], 256: [3], 475: [1314, 1336], 880: [1011], 948: [130], 1319: [1275], 1420: [130], 16: [592], 97: [1196, 1319], 246: [1420], 673: [592], 1026: [1275], 1383: [880], 1408: [998, 989, 256], 346: [246], 406: [880], 1056: [440], 32: [673], 77: [1408], 461: [475, 406], 906: [1319], 918: [673], 959: [16], 1116: [948], 1240: [1056], 1366: [673], 124: [1366], 649: [959], 799: [1240], 961: [1116], 1436: [1383], 1446: [1026], 10: [918, 1366], 1078: [97, 906], 1278: [1436], 103: [799], 207: [124, 649, 10], 703: [1436], 742: [959], 1338: [1240], 453: [1078], 526: [1338], 631: [742], 747: [1338], 752: [1278], 978: [906, 1446], 238: [1278], 718: [752], 879: [77], 974: [747], 1227: [124, 703], 424: [718], 444: [453], 570: [1078, 978], 1264: [526, 747], 11: [961], 85: [1227], 111: [631], 267: [1227], 894: [879], 1052: [207], 1155: [1264], 198: [424], 701: [1264], 812: [974], 930: [974], 1360: [11], 1467: [974], 667: [267, 1052], 675: [1467], 833: [701], 865: [894], 871: [1155], 942: [570], 1007: [111], 94: [85], 402: [894], 783: [267], 941: [667, 1007], 1030: [675], 1460: [11], 337: [1052], 768: [930], 1036: [198], 61: [783], 810: [871], 1216: [402], 1247: [871], 1306: [337], 1361: [941], 1365: [941], 344: [1306], 505: [337], 816: [1216], 395: [1216], 821: [1361], 1121: [768], 531: [1306], 907: [1216], 1068: [821], 1127: [1247], 1349: [1460], 843: [816], 1044: [907], 1312: [1127], 66: [1068], 606: [843], 935: [1312], 281: [1349], 537: [843], 994: [1312], 1146: [1247], 1198: [843], 1262: [1361, 1365, 531], 398: [1198], 549: [843], 1187: [994], 55: [66], 300: [1187], 481: [281], 634: [606, 1262], 682: [606], 825: [1146], 1049: [66], 139: [1049], 314: [634], 420: [1049], 607: [549], 775: [281], 898: [634], 1382: [549], 59: [682], 640: [898], 985: [481], 734: [775], 888: [139], 1244: [1382], 1304: [314], 1377: [55], 177: [888], 270: [1304], 305: [1244], 1309: [898, 59], 1400: [898], 463: [305], 1469: [177], 483: [1309], 709: [734], 1212: [1304], 4: [305, 1400], 127: [305], 778: [1469], 873: [177], 1246: [1469], 1286: [1309], 1444: [463], 190: [778, 1246], 437: [709], 884: [873], 1058: [1286], 529: [127], 603: [270], 628: [709], 1147: [437], 1485: [437], 80: [1147], 317: [4], 330: [778, 1246], 870: [1485], 304: [1058], 910: [870], 258: [330], 414: [317], 583: [80], 661: [529], 1110: [80], 1132: [1485], 1380: [1147], 99: [190, 330], 293: [1132], 692: [910], 1427: [661], 68: [692], 219: [910], 255: [99], 502: [304], 719: [661], 970: [293], 1074: [1427], 1169: [583], 1287: [293], 1342: [293], 93: [68], 485: [255], 651: [258], 915: [258], 950: [970], 955: [68], 966: [1132, 1380], 1067: [692], 75: [970], 149: [502], 191: [970, 1342], 397: [1074], 859: [1169], 1182: [1169], 1373: [99], 1387: [502], 117: [1110], 450: [1287], 472: [1182], 666: [1067], 1375: [955], 1406: [1182], 1471: [1169], 128: [191], 193: [1182], 513: [472, 1406], 656: [692, 1342], 760: [1182], 1043: [859], 1455: [1182], 306: [397], 710: [1471], 1105: [472], 1352: [450], 1410: [1387], 489: [1455], 800: [117], 984: [193], 105: [710], 174: [193], 348: [656], 363: [485, 1105], 411: [800], 806: [656], 848: [128], 1184: [513], 379: [1105], 749: [306], 1145: [1352], 310: [411], 486: [1375], 669: [1043], 1014: [984], 1027: [379], 60: [806], 202: [105], 376: [174], 914: [749], 1340: [666], 241: [202], 488: [379], 547: [310], 614: [486], 72: [1340], 429: [1014], 968: [310], 1150: [486], 1303: [1340], 1473: [547], 636: [914], 726: [429], 784: [1027, 429], 951: [72], 50: [429], 361: [241], 1253: [636], 214: [361], 431: [1473], 795: [50], 1061: [726], 1148: [1303], 1236: [784], 1249: [636], 1439: [784], 462: [951], 613: [951], 750: [431], 962: [951], 969: [50], 1206: [1439], 835: [795, 969], 1086: [795], 1203: [962], 49: [1148, 462, 962], 321: [1206], 435: [795], 514: [969], 740: [1249], 986: [968, 969], 1088: [1203], 1327: [613], 1376: [1086], 521: [1327], 946: [1327], 1115: [1327], 1441: [321], 1450: [435], 179: [521], 288: [946], 982: [986], 200: [179], 743: [1450], 785: [1441], 316: [288], 730: [200], 1345: [750, 1441], 1372: [743], 1458: [982], 275: [179], 1120: [1372], 1130: [1372], 1141: [316], 1449: [200], 446: [1458], 844: [1120], 1041: [200], 1457: [743], 345: [1457], 425: [446], 552: [1449], 646: [1041], 933: [1449], 992: [1457], 1193: [730], 442: [844], 573: [1457], 868: [1141], 1231: [275], 261: [1231], 560: [573], 797: [1231], 905: [868], 1152: [552], 1310: [442], 1417: [425], 13: [345, 992], 289: [933], 292: [425], 882: [1152], 1032: [1130, 992], 1118: [1231], 73: [868], 164: [13], 332: [1118], 1017: [1032], 1089: [868], 1135: [1152], 517: [1310], 523: [1152], 676: [1310], 841: [1417], 943: [13], 1040: [560], 1468: [1417], 203: [517], 588: [841], 808: [1089], 1195: [882], 1478: [1118], 307: [1478], 555: [517, 676], 757: [808], 774: [1135], 1140: [73], 1143: [1135], 1484: [943], 144: [1140], 741: [774], 988: [203, 1143], 1144: [1484], 1476: [1468], 126: [1478], 296: [757], 625: [741], 1004: [1476], 1136: [144], 756: [296], 54: [756], 262: [144], 368: [988], 1124: [1476], 1282: [741], 1288: [1004], 1428: [741], 594: [1004], 1139: [1004], 1355: [1428], 1451: [1124], 175: [594], 224: [368], 542: [296, 262], 1208: [1139], 1293: [1124], 143: [307], 162: [368], 247: [126], 510: [1428], 1051: [542], 1160: [1293], 52: [625, 542], 487: [247], 593: [224, 162], 908: [510], 1315: [247], 194: [1208], 518: [143], 557: [52], 589: [175], 731: [1355, 510], 1093: [175], 362: [557], 759: [224, 162], 995: [52], 1037: [1051], 1328: [487], 1402: [518], 223: [1328], 1082: [593], 1122: [143], 1137: [995], 1363: [593], 1481: [1328], 572: [1137], 714: [1402], 804: [1082], 89: [1402], 1251: [1137], 1434: [1122], 1220: [1251], 158: [223], 260: [1251], 605: [714], 509: [260], 519: [1220], 543: [260], 769: [158], 556: [519, 543], 598: [605], 1416: [543], 136: [158], 184: [598], 600: [605], 976: [158], 1335: [509], 86: [1335], 1202: [1416], 1248: [543], 188: [184], 410: [136], 551: [184], 641: [1335], 1018: [598], 1386: [136], 23: [976], 137: [188], 323: [86], 383: [136], 541: [556, 1335], 665: [1386], 685: [1248], 1066: [551], 1300: [184, 1018], 331: [685], 671: [1300], 773: [410], 878: [685], 1003: [86], 1289: [551], 1418: [410], 229: [773], 274: [137], 539: [383], 687: [685], 927: [323], 1090: [1066], 1109: [1066], 971: [1289], 1200: [410, 23], 1223: [331], 1228: [878], 141: [773], 582: [671], 619: [1109], 693: [927], 838: [274], 1166: [687], 225: [971], 793: [1223], 1331: [141], 1432: [838], 45: [1166], 497: [1223], 580: [1228], 852: [693], 891: [1432], 48: [1331], 343: [891], 469: [582], 591: [1166], 654: [497], 765: [45], 1154: [551], 1283: [45], 64: [225], 478: [793, 497], 535: [852], 681: [1154], 707: [1090, 971], 1437: [1154], 204: [64], 254: [891], 926: [1437], 1285: [1283], 100: [765], 205: [591], 724: [343], 754: [64], 811: [681], 1054: [654], 1413: [204], 151: [681], 216: [478], 790: [1109, 681], 1374: [724], 1385: [478], 283: [1385], 829: [1285], 1175: [811], 1339: [790], 239: [225], 269: [151], 459: [254], 832: [1054, 1385], 876: [239], 896: [1413], 1117: [239], 736: [829], 751: [283, 239], 273: [1117], 352: [736], 377: [736], 664: [736], 678: [736], 721: [273], 156: [751], 761: [751], 1350: [751], 712: [377], 862: [664], 911: [273], 1267: [156], 1281: [721], 527: [1281], 632: [678], 782: [1267], 847: [721], 997: [1267], 1133: [911], 584: [782], 596: [782], 1102: [1133], 297: [911], 567: [632], 620: [847], 901: [596], 1104: [632], 1123: [862], 1194: [596], 360: [567], 494: [1133], 562: [997], 231: [360], 349: [297], 668: [1123], 779: [360], 856: [901], 18: [527], 645: [856], 670: [1104], 1094: [620], 63: [562], 421: [562], 1046: [645], 1111: [856], 1465: [779], 617: [668], 766: [494, 349], 802: [1094], 958: [231], 1019: [1111], 1229: [1094], 33: [1094], 370: [421, 617], 388: [1465], 980: [18], 1055: [645], 171: [1229], 180: [1229, 33], 196: [370], 644: [1229], 837: [421], 1259: [63], 44: [171, 180], 853: [388], 999: [980], 1016: [766], 1103: [958], 1233: [370], 78: [644], 118: [180], 294: [802, 33], 387: [196], 633: [980], 1008: [837], 1260: [644], 15: [78, 1260], 150: [853], 152: [1260], 426: [78], 1035: [837, 1259], 1215: [196, 1233], 211: [44], 457: [1008, 1035], 1047: [15, 152], 1129: [152], 1295: [1103], 67: [294, 457], 623: [152], 1258: [1047], 30: [633], 371: [1129], 385: [1215], 415: [1035], 657: [211], 684: [150], 235: [999], 586: [415], 663: [684], 866: [657], 1384: [657], 809: [1258, 1384], 916: [415], 496: [809], 917: [415], 921: [235], 1072: [235], 24: [1258, 371], 302: [866], 328: [586], 554: [916], 1077: [866], 1367: [921], 1369: [663], 1472: [921], 599: [554], 776: [980, 916], 803: [1077], 1108: [1077], 1197: [328], 1241: [1369], 1430: [809], 186: [1197], 257: [803], 550: [1072], 568: [1108], 860: [776], 965: [302], 972: [776], 1210: [599], 1332: [1472], 65: [550], 356: [972], 642: [302], 1119: [1430], 1261: [554], 237: [496, 1430, 965], 320: [257], 393: [356], 854: [1197], 1177: [803, 965], 227: [320], 409: [1332], 715: [972], 1183: [1332], 1370: [550], 1423: [965, 642], 1479: [186], 647: [715], 720: [65], 886: [1423], 1059: [237], 1353: [1261], 264: [24, 393], 1107: [1370], 1225: [1059], 206: [1183], 280: [1183], 828: [264], 301: [1370], 324: [1367], 438: [1059], 840: [1353], 69: [264], 95: [324], 558: [1423, 828], 706: [720], 842: [706], 936: [95], 977: [1107, 301], 1344: [828, 69], 1422: [280], 375: [977], 611: [706], 1015: [706], 1483: [438], 351: [95], 378: [1015], 545: [1422], 585: [842], 725: [568, 69], 1033: [558, 1344], 53: [977], 218: [611], 571: [545], 575: [1344], 875: [351], 1238: [936], 622: [351], 694: [1033], 1131: [1015], 303: [694], 587: [1238], 786: [694], 1174: [378], 1270: [351], 1394: [1131], 1447: [622], 87: [218], 635: [875], 745: [375], 1256: [1238], 1429: [375], 271: [694], 912: [587, 1256], 1106: [622], 37: [53], 449: [1394], 525: [1429], 805: [587, 1256], 827: [1174], 1221: [1394], 1277: [1270], 1279: [1106], 322: [635], 579: [635], 728: [449], 932: [449], 1265: [87], 1390: [1279], 1438: [912], 110: [1221], 243: [37], 851: [322], 967: [1390], 1294: [728], 41: [967], 165: [932], 677: [1447, 1277], 1326: [1265], 1421: [805], 1445: [1221], 251: [110], 430: [1326], 533: [851], 1101: [1421], 1156: [1438, 1421], 1482: [1294], 522: [1482], 796: [41], 1042: [1326], 1232: [1421], 1271: [677], 1290: [1482], 20: [1290], 163: [522], 372: [1042], 626: [533], 781: [1271], 1031: [243], 441: [20], 508: [1232], 520: [626], 928: [1031], 629: [372], 155: [626], 963: [1042], 993: [110], 1081: [1031], 1097: [372], 389: [1097], 883: [963], 1149: [796], 1191: [993], 452: [883], 1452: [1097], 326: [155], 495: [993], 858: [1097], 1219: [883], 1189: [1191], 1209: [452], 1214: [858], 157: [1209], 716: [858], 1323: [495], 467: [1209], 1207: [1191, 495], 315: [157], 386: [716], 443: [467], 1243: [1323], 1371: [1214], 423: [1243], 904: [716], 1409: [443], 1462: [1371], 215: [443], 249: [1243], 1222: [423], 1307: [1371], 226: [386, 904], 732: [315], 953: [1243], 1396: [1409], 1337: [953], 57: [249], 268: [249, 953], 445: [1222], 569: [215], 937: [423, 953], 934: [226], 1442: [1396], 71: [934], 624: [268], 655: [1462], 849: [1337, 937], 1280: [937], 70: [1442], 115: [1280], 392: [569], 499: [1442], 1162: [71], 1254: [849], 1459: [624], 96: [849], 187: [934], 1217: [1459], 1356: [392], 58: [71], 201: [1162], 335: [70], 1333: [445, 71], 1456: [1442], 113: [187], 512: [115], 818: [1356], 98: [1217], 448: [1456], 691: [818], 767: [1456], 855: [201], 1161: [187], 134: [767], 236: [113], 350: [98], 1297: [691], 1412: [335], 1474: [1162, 1333], 408: [335, 767], 464: [448], 748: [98], 780: [350], 1362: [1474], 1397: [96], 182: [1397], 604: [1362], 680: [113, 1161], 688: [499, 767], 890: [1397], 1022: [691], 1028: [464], 47: [680], 355: [688], 1020: [855], 1321: [1022], 590: [780], 210: [464], 221: [680], 381: [47], 698: [890], 1021: [604], 1173: [1412], 949: [1021], 1172: [210], 19: [1173], 26: [381], 109: [1172], 465: [221], 491: [698], 528: [698], 160: [221], 192: [1028, 210], 220: [1021], 1159: [26], 538: [528], 1005: [19], 142: [160], 794: [1005], 830: [160], 1071: [949, 538], 1153: [528], 1237: [491], 119: [794], 197: [160], 419: [1237], 1453: [1172], 35: [794], 621: [1159], 643: [1237], 777: [419], 903: [538, 1153], 1050: [1005], 1211: [830], 34: [119], 168: [777], 574: [197], 846: [197], 1002: [1050], 138: [109, 1453], 365: [1211], 679: [846], 1045: [1211], 1213: [34], 1242: [35], 1443: [1071, 903], 2: [643], 287: [192], 559: [1213], 897: [35], 1341: [465, 1211], 8: [1045], 500: [287], 881: [1443], 909: [168], 1170: [846], 166: [365], 367: [287], 451: [897], 819: [1443], 850: [365, 1341], 957: [1242], 1010: [1242], 1076: [1002], 1305: [574], 230: [451, 957, 1010], 864: [679], 924: [166], 947: [903, 1170], 1346: [850], 473: [1010], 639: [957], 990: [230], 1291: [367, 864], 208: [909, 1305], 199: [230, 639], 259: [473], 374: [208], 524: [208], 704: [864], 336: [639], 506: [1291], 610: [473], 877: [1291], 108: [506], 1358: [819], 83: [374], 416: [199], 1226: [506], 498: [877], 975: [610], 1083: [336], 1454: [1358], 738: [1226], 1075: [975], 240: [416], 845: [498], 931: [1083], 940: [1083], 1134: [1075], 1433: [1010], 653: [738], 770: [498], 889: [1454], 1463: [259], 12: [1075], 353: [931], 1073: [738], 456: [1433], 530: [931], 1257: [240, 931], 1401: [770], 418: [353], 822: [530], 1178: [1257], 347: [975], 544: [1401], 1359: [822], 683: [1134], 1389: [347], 178: [1178], 532: [1359], 576: [347], 823: [544], 1171: [1389], 146: [1171], 561: [1171], 861: [1359], 1440: [823], 25: [178], 43: [532], 534: [532], 735: [532], 1188: [1171], 167: [25], 1053: [1440], 1100: [178], 1388: [43], 28: [146], 515: [43], 615: [1388], 618: [861, 1388], 737: [1053], 807: [1100], 939: [167], 981: [43], 1302: [534], 1405: [1440], 474: [25], 1065: [515], 213: [737], 717: [1302], 1348: [1302], 1426: [474], 1477: [618], 470: [1348], 762: [717], 382: [717], 1057: [470], 1199: [470], 1354: [470], 42: [1354], 820: [382], 857: [1057, 1199], 1164: [382], 340: [1354], 1284: [42], 81: [857], 503: [1164], 689: [820], 1296: [340], 1351: [1284], 1062: [81], 727: [1296], 1391: [689], 504: [727], 601: [1351], 6: [1062], 242: [601], 366: [504], 401: [601], 477: [6], 869: [504], 952: [6], 390: [504], 648: [366], 887: [601], 1273: [504], 74: [869, 390], 120: [366], 536: [1273], 945: [887], 405: [242], 892: [74, 536], 1329: [648], 895: [405], 1480: [945], 31: [895], 458: [536], 540: [1329], 399: [405], 1218: [405], 298: [31], 466: [1480], 609: [895], 308: [458], 920: [458], 1128: [399], 1415: [540], 313: [466], 979: [31], 1190: [298], 1192: [609], 1334: [1415], 364: [313], 1411: [31, 609], 964: [920], 744: [979], 1085: [313], 1125: [364], 1157: [1125], 1234: [964], 396: [744], 577: [1125], 652: [1085], 228: [652], 295: [396], 318: [1234], 480: [1157], 899: [228], 253: [577], 422: [652], 1092: [480], 1185: [577], 1357: [899], 1393: [422], 14: [422], 839: [899], 1024: [480], 1475: [318], 5: [1092], 1012: [839], 148: [1012], 566: [1475], 1006: [1357], 183: [1475], 1001: [253], 1084: [1024], 1276: [295, 1475], 1317: [5], 252: [1084], 1425: [1317], 129: [1425], 169: [1276], 697: [148], 699: [183], 814: [566, 1276], 112: [814], 121: [814], 413: [1084], 672: [1084], 686: [1006], 1112: [129], 1392: [1276], 39: [699], 133: [686], 189: [121], 299: [252], 893: [129], 1201: [697], 285: [112], 342: [39], 490: [5], 627: [839, 1392], 1313: [893], 400: [112], 563: [686], 637: [133], 834: [299], 1080: [1112], 1381: [285, 342], 22: [133], 658: [413, 672, 490], 1180: [563], 1186: [1201], 1404: [189], 501: [627], 922: [1317, 490], 427: [922], 826: [834], 1179: [834], 1431: [637, 22], 511: [1201, 22], 722: [637, 22], 1151: [658], 1158: [189, 501], 1347: [1179], 1399: [129], 140: [1431], 436: [722], 764: [1151], 787: [1431], 1038: [427], 700: [1399], 817: [826], 1098: [1347], 1301: [764], 1322: [722], 1461: [1347], 9: [1098, 1461], 147: [511], 630: [787], 874: [817], 913: [1151], 92: [630], 284: [913], 507: [1038], 564: [700], 27: [1186], 391: [1098], 476: [1301], 900: [564], 991: [147], 181: [507], 432: [27], 433: [284], 460: [630], 468: [9], 493: [834], 546: [834], 125: [991], 277: [468], 659: [546], 885: [432], 17: [92], 62: [27], 76: [476], 702: [493], 746: [1461, 991], 938: [391], 1255: [391], 1266: [900], 1470: [181], 695: [1266], 983: [885], 1025: [695], 1325: [1266], 102: [62], 114: [983], 265: [695, 1325], 404: [702], 434: [17], 788: [1470], 116: [1025], 290: [983], 1167: [434], 1330: [983], 282: [114], 334: [114, 290], 428: [1167], 484: [116], 565: [788], 608: [1025], 863: [1325], 1023: [277], 1239: [404], 159: [114], 925: [428], 1009: [1239], 1142: [484], 1165: [863], 1378: [1023], 90: [608], 107: [484], 447: [290], 739: [290], 792: [1330], 1181: [565], 29: [1378], 516: [1181], 553: [282], 616: [90], 815: [1023], 831: [90], 1039: [1009], 1448: [159], 161: [1039], 286: [863, 1181], 373: [792], 455: [107], 1250: [616], 1398: [1039], 82: [29], 132: [739], 279: [616, 831], 312: [1378, 1448], 836: [792], 1126: [373], 234: [836], 384: [312], 660: [815], 662: [29], 1070: [815], 1079: [312], 1138: [312], 1235: [1250], 1379: [553], 145: [1070], 791: [384], 973: [1079], 1419: [1235], 1464: [279], 1407: [973], 650: [1070], 690: [1464], 798: [234], 801: [662], 1069: [1419], 1368: [973], 51: [798], 122: [798], 135: [1464], 333: [650], 1063: [973], 278: [650], 1272: [122], 1298: [690], 1318: [1069], 38: [122], 713: [1298], 996: [51], 1414: [278], 7: [1414], 1263: [278], 1274: [1318], 176: [38], 276: [1272], 674: [1318], 56: [276], 471: [176], 1316: [1263], 272: [56], 329: [176], 1095: [1274], 84: [1316], 106: [329], 1013: [176], 1091: [674], 263: [56], 755: [1316], 1064: [329], 21: [84], 88: [106], 824: [263], 244: [1064], 123: [88], 153: [1064], 1269: [244], 245: [123], 578: [21], 758: [244], 872: [1269], 1034: [153], 763: [872], 482: [872], 1268: [763], 222: [1268], 394: [1268], 595: [222, 394], 696: [222, 394], 1: [595]}
        #

        print(intersections_up)
        print(len(intersections_up))
        print(intersections_down)
        print(len(intersections_down))

        removable = []
        no_intersection = []
        for rect in data:
            label = rect[2]
            can_remove = True
            for x in intersections_down:
                intersection = intersections_down[x]
                if label in intersection and len(intersection) == 1:
                    can_remove = False
                    break
            if can_remove:
                if label not in removable:
                    removable.append(label)

        # print(sorted(removable))
        # print(sorted(no_intersection))
        #
        # print(len(removable))
        # print(len(no_intersection))


        return len(removable)

    def stack_bricks(self, data):
        count = 0
        stack = []
        intersections_up = defaultdict(list)
        intersections_down = defaultdict(list)
        for rect in data:
            count += 1
            # print(count)
            coord1 = rect[0]
            coord2 = rect[1]
            if coord1[2] > 1:
                intersect_count = 0
                new_rect = [[coord1[0], coord1[1], coord1[2]],
                            [coord2[0], coord2[1], coord2[2]], rect[2]]
                while intersect_count == 0:
                    new_rect[0][2] -= 1
                    new_rect[1][2] -= 1

                    for old_rect in stack:
                        if self.intersect(old_rect, new_rect):
                            intersect_count += 1
                            intersections_up[old_rect[2]].append(new_rect[2])
                            intersections_down[new_rect[2]].append(old_rect[2])

                    if new_rect[0][2] == 1 or new_rect[1][2] == 1:
                        break
                if intersect_count != 0:
                    new_rect[0][2] += 1
                    new_rect[1][2] += 1

                stack.append(new_rect)
                pass
            else:
                stack.append(rect)

        return stack, intersections_down, intersections_up

    def remove_brick(self, start_name, intersections_up, intersections_down):
        bricks_removed = []
        # seen = {}
        q = [start_name]
        bricks_removed += [start_name]
        while len(q) > 0:
            brick_name = q.pop(0)
            # if brick_name in seen:
            #     continue
            # seen[brick_name] = True
            # print(f'brick={brick_name}')
            if brick_name not in intersections_up:
                continue
            for intersected_brick_name in intersections_up[brick_name]:
                if intersected_brick_name in bricks_removed:
                    continue
                supporting_bricks = intersections_down[intersected_brick_name]
                intersection = [value for value in supporting_bricks if value in bricks_removed]
                if len(supporting_bricks) == len(intersection):
                    q.append(intersected_brick_name)
                    bricks_removed += [intersected_brick_name]

        #
        # for intersected_brick_names in intersections_up[brick_name]:
        #     supporting_bricks = intersections_down[intersected_brick_names]
        #     intersection = [value for value in supporting_bricks if value in bricks_removed]
        #     if len(supporting_bricks) == len(intersection):
        #         self.remove_brick(intersected_brick_names, intersections_up, intersections_down, bricks_removed)

        return len(bricks_removed) - 1

    def calc_2(self, data: [str]) -> int:
        # stack, intersections_down, intersections_up = self.stack_bricks(data)

        intersections_up = {403: [944], 1324: [1299], 1230: [380], 369: [380, 1060], 359: [454], 1308: [454], 705: [454], 417: [723], 1113: [1311, 711, 412, 1292], 1163: [1466], 1299: [358], 771: [711], 1060: [1403], 358: [407], 723: [708], 944: [956], 407: [233, 250, 929], 711: [772, 1096, 311], 454: [1099], 380: [1395], 412: [1435, 311], 233: [338, 104], 1435: [479], 708: [753, 729], 1099: [919, 341], 1395: [1087], 1403: [1114], 956: [1224], 479: [172, 325], 597: [232], 1114: [266], 1311: [311], 1087: [1029, 439], 753: [1245], 929: [867], 1029: [867], 1224: [1176, 354], 311: [40, 79, 789], 1096: [1252], 232: [327, 339], 1176: [813], 729: [902], 172: [923], 772: [36], 1252: [154], 354: [492, 170, 173], 327: [1364], 439: [46], 40: [212, 1343], 79: [248], 339: [733], 867: [954, 185, 3], 492: [1204], 36: [209, 960, 291], 170: [319], 248: [357, 602, 1320], 923: [581], 1364: [1000], 212: [548], 954: [998, 130], 209: [1048, 131], 46: [185, 3], 960: [987], 602: [3], 185: [989], 1000: [1011], 998: [1196, 1275, 1408], 987: [1314], 3: [130, 256], 1320: [195], 1314: [440, 475], 1011: [592, 880], 291: [1168], 1048: [1336], 1336: [475], 130: [948, 1420], 1275: [1319, 1026], 592: [16, 673], 1196: [97], 1319: [97, 906], 1420: [246], 880: [1383, 406], 989: [1408], 256: [1408], 246: [346], 440: [1056], 673: [32, 918, 1366], 1408: [77], 475: [461], 406: [461], 16: [959], 948: [1116], 1056: [1240], 1366: [124, 10], 959: [649, 742], 1240: [799, 1338], 1116: [961], 1383: [1436], 1026: [1446], 918: [10], 97: [1078], 906: [1078, 978], 1436: [1278, 703], 799: [103], 124: [207, 1227], 649: [207], 10: [207], 1078: [453, 570], 1338: [526, 747], 742: [631], 1278: [752, 238], 1446: [978], 752: [718], 77: [879], 747: [974, 1264], 703: [1227], 718: [424], 453: [444], 978: [570], 526: [1264], 961: [11], 1227: [85, 267], 631: [111], 879: [894], 207: [1052], 1264: [1155, 701], 424: [198], 974: [812, 930, 1467], 11: [1360, 1460], 267: [667, 783], 1052: [667, 337], 1467: [675], 701: [833], 894: [865, 402], 1155: [871], 570: [942], 111: [1007], 85: [94], 667: [941], 1007: [941], 675: [1030], 930: [768], 198: [1036], 783: [61], 871: [810, 1247], 402: [1216], 337: [1306, 505], 941: [1361, 1365], 1306: [344, 531], 1216: [816, 395, 907], 1361: [821, 1262], 768: [1121], 821: [1068], 1247: [1127, 1146], 1460: [1349], 816: [843], 907: [1044], 1127: [1312], 1068: [66], 843: [606, 537, 1198, 549], 1312: [935, 994], 1349: [281], 1365: [1262], 531: [1262], 1198: [398], 994: [1187], 66: [55, 1049], 1187: [300], 281: [481, 775], 606: [634, 682], 1262: [634], 1146: [825], 1049: [139, 420], 634: [314, 898], 549: [607, 1382], 682: [59], 898: [640, 1309, 1400], 481: [985], 775: [734], 139: [888], 1382: [1244], 314: [1304], 55: [1377], 888: [177], 1304: [270, 1212], 1244: [305], 59: [1309], 305: [463, 4, 127], 177: [1469, 873], 1309: [483, 1286], 734: [709], 1400: [4], 1469: [778, 1246], 463: [1444], 778: [190, 330], 1246: [190, 330], 709: [437, 628], 873: [884], 1286: [1058], 127: [529], 270: [603], 437: [1147, 1485], 1147: [80, 1380], 4: [317], 1485: [870, 1132], 1058: [304], 870: [910], 330: [258, 99], 317: [414], 80: [583, 1110], 529: [661], 190: [99], 1132: [293, 966], 910: [692, 219], 661: [1427, 719], 692: [68, 1067, 656], 99: [255, 1373], 304: [502], 293: [970, 1287, 1342], 1427: [1074], 583: [1169], 68: [93, 955], 255: [485], 258: [651, 915], 970: [950, 75, 191], 1380: [966], 502: [149, 1387], 1342: [191, 656], 1074: [397], 1169: [859, 1182, 1471], 1110: [117], 1287: [450], 1182: [472, 1406, 193, 760, 1455], 1067: [666], 955: [1375], 191: [128], 472: [513, 1105], 1406: [513], 859: [1043], 397: [306], 1471: [710], 450: [1352], 1387: [1410], 1455: [489], 117: [800], 193: [984, 174], 710: [105], 656: [348, 806], 485: [363], 1105: [363, 379], 800: [411], 128: [848], 513: [1184], 306: [749], 1352: [1145], 411: [310], 1375: [486], 1043: [669], 984: [1014], 379: [1027, 488], 806: [60], 105: [202], 174: [376], 749: [914], 666: [1340], 202: [241], 310: [547, 968], 486: [614, 1150], 1340: [72, 1303], 1014: [429], 547: [1473], 914: [636], 429: [726, 784, 50], 1027: [784], 72: [951], 241: [361], 636: [1253, 1249], 361: [214], 1473: [431], 50: [795, 969], 726: [1061], 1303: [1148], 784: [1236, 1439], 951: [462, 613, 962], 431: [750], 1439: [1206], 795: [835, 1086, 435], 969: [835, 514, 986], 962: [1203, 49], 1148: [49], 462: [49], 1206: [321], 1249: [740], 968: [986], 1203: [1088], 613: [1327], 1086: [1376], 1327: [521, 946, 1115], 321: [1441], 435: [1450], 521: [179], 946: [288], 986: [982], 179: [200, 275], 1450: [743], 1441: [785, 1345], 288: [316], 200: [730, 1449, 1041], 750: [1345], 743: [1372, 1457], 982: [1458], 1372: [1120, 1130], 316: [1141], 1458: [446], 1120: [844], 1457: [345, 992, 573], 446: [425], 1449: [552, 933], 1041: [646], 730: [1193], 844: [442], 1141: [868], 275: [1231], 1231: [261, 797, 1118], 573: [560], 868: [905, 73, 1089], 552: [1152], 442: [1310], 425: [1417, 292], 345: [13], 992: [13, 1032], 933: [289], 1152: [882, 1135, 523], 1130: [1032], 13: [164, 943], 1118: [332, 1478], 1032: [1017], 1310: [517, 676], 1417: [841, 1468], 560: [1040], 517: [203, 555], 841: [588], 1089: [808], 882: [1195], 1478: [307, 126], 676: [555], 808: [757], 1135: [774, 1143], 73: [1140], 943: [1484], 1140: [144], 774: [741], 203: [988], 1143: [988], 1484: [1144], 1468: [1476], 757: [296], 741: [625, 1282, 1428], 1476: [1004, 1124], 144: [1136, 262], 296: [756, 542], 756: [54], 988: [368], 1004: [1288, 594, 1139], 1428: [1355, 510], 1124: [1451, 1293], 594: [175], 368: [224, 162], 262: [542], 1139: [1208], 307: [143], 126: [247], 542: [1051, 52], 1293: [1160], 625: [52], 247: [487, 1315], 224: [593, 759], 162: [593, 759], 510: [908, 731], 1208: [194], 143: [518, 1122], 52: [557, 995], 175: [589, 1093], 1355: [731], 557: [362], 1051: [1037], 487: [1328], 518: [1402], 1328: [223, 1481], 593: [1082, 1363], 995: [1137], 1137: [572, 1251], 1402: [714, 89], 1082: [804], 1122: [1434], 1251: [1220, 260], 223: [158], 714: [605], 260: [509, 543], 1220: [519], 158: [769, 136, 976], 519: [556], 543: [556, 1416, 1248], 605: [598, 600], 598: [184, 1018], 509: [1335], 1335: [86, 641, 541], 1416: [1202], 184: [188, 551, 1300], 136: [410, 1386, 383], 976: [23], 188: [137], 86: [323, 1003], 556: [541], 1386: [665], 1248: [685], 551: [1066, 1289, 1154], 1018: [1300], 685: [331, 878, 687], 1300: [671], 410: [773, 1418, 1200], 773: [229, 141], 137: [274], 383: [539], 323: [927], 1066: [1090, 1109], 1289: [971], 23: [1200], 331: [1223], 878: [1228], 671: [582], 1109: [619, 790], 927: [693], 274: [838], 687: [1166], 971: [225, 707], 1223: [793, 497], 141: [1331], 838: [1432], 1166: [45, 591], 1228: [580], 693: [852], 1432: [891], 1331: [48], 891: [343, 254], 582: [469], 497: [654, 478], 45: [765, 1283], 225: [64, 239], 793: [478], 852: [535], 1154: [681, 1437], 1090: [707], 64: [204, 754], 1437: [926], 1283: [1285], 765: [100], 591: [205], 343: [724], 681: [811, 151, 790], 654: [1054], 204: [1413], 478: [216, 1385], 724: [1374], 1385: [283, 832], 1285: [829], 811: [1175], 790: [1339], 151: [269], 254: [459], 1054: [832], 239: [876, 1117, 751], 1413: [896], 829: [736], 283: [751], 1117: [273], 736: [352, 377, 664, 678], 273: [721, 911], 751: [156, 761, 1350], 377: [712], 664: [862], 156: [1267], 721: [1281, 847], 1281: [527], 678: [632], 1267: [782, 997], 911: [1133, 297], 782: [584, 596], 1133: [1102, 494], 632: [567, 1104], 847: [620], 596: [901, 1194], 862: [1123], 567: [360], 997: [562], 360: [231, 779], 297: [349], 1123: [668], 901: [856], 527: [18], 856: [645, 1111], 1104: [670], 620: [1094], 562: [63, 421], 645: [1046, 1055], 779: [1465], 668: [617], 494: [766], 349: [766], 1094: [802, 1229, 33], 231: [958], 1111: [1019], 421: [370, 837], 617: [370], 1465: [388], 18: [980], 1229: [171, 180, 644], 33: [180, 294], 370: [196, 1233], 63: [1259], 171: [44], 180: [44, 118], 388: [853], 980: [999, 633, 776], 766: [1016], 958: [1103], 644: [78, 1260], 802: [294], 196: [387, 1215], 837: [1008, 1035], 78: [15, 426], 1260: [15, 152], 853: [150], 1259: [1035], 1233: [1215], 44: [211], 1008: [457], 1035: [457, 415], 15: [1047], 152: [1047, 1129, 623], 1103: [1295], 294: [67], 457: [67], 1047: [1258], 633: [30], 1129: [371], 1215: [385], 211: [657], 150: [684], 999: [235], 415: [586, 916, 917], 684: [663], 657: [866, 1384], 1258: [809, 24], 1384: [809], 809: [496, 1430], 235: [921, 1072], 371: [24], 866: [302, 1077], 586: [328], 916: [554, 776], 921: [1367, 1472], 663: [1369], 554: [599, 1261], 1077: [803, 1108], 328: [1197], 1369: [1241], 1197: [186, 854], 803: [257, 1177], 1072: [550], 1108: [568], 776: [860, 972], 302: [965, 642], 599: [1210], 1472: [1332], 550: [65, 1370], 972: [356, 715], 1430: [1119, 237], 496: [237], 965: [237, 1177, 1423], 257: [320], 356: [393], 320: [227], 1332: [409, 1183], 642: [1423], 186: [1479], 715: [647], 65: [720], 1423: [886, 558], 237: [1059], 1261: [1353], 24: [264], 393: [264], 1370: [1107, 301], 1059: [1225, 438], 1183: [206, 280], 264: [828, 69], 1367: [324], 1353: [840], 324: [95], 828: [558, 1344], 720: [706], 706: [842, 611, 1015], 95: [936, 351], 1107: [977], 301: [977], 69: [1344, 725], 280: [1422], 977: [375, 53], 438: [1483], 1015: [378, 1131], 1422: [545], 842: [585], 568: [725], 558: [1033], 1344: [1033, 575], 611: [218], 545: [571], 351: [875, 622, 1270], 936: [1238], 1033: [694], 694: [303, 786, 271], 1238: [587, 1256], 378: [1174], 1131: [1394], 622: [1447, 1106], 218: [87], 875: [635], 375: [745, 1429], 587: [912, 805], 1256: [912, 805], 53: [37], 1394: [449, 1221], 1429: [525], 1174: [827], 1270: [1277], 1106: [1279], 635: [322, 579], 449: [728, 932], 87: [1265], 1279: [1390], 912: [1438], 1221: [110, 1445], 37: [243], 322: [851], 1390: [967], 728: [1294], 967: [41], 932: [165], 1447: [677], 1277: [677], 1265: [1326], 805: [1421], 110: [251, 993], 1326: [430, 1042], 851: [533], 1421: [1101, 1156, 1232], 1438: [1156], 1294: [1482], 1482: [522, 1290], 41: [796], 677: [1271], 1290: [20], 522: [163], 1042: [372, 963], 533: [626], 1271: [781], 243: [1031], 20: [441], 1232: [508], 626: [520, 155], 1031: [928, 1081], 372: [629, 1097], 1097: [389, 1452, 858], 963: [883], 796: [1149], 993: [1191, 495], 883: [452, 1219], 155: [326], 1191: [1189, 1207], 452: [1209], 858: [1214, 716], 1209: [157, 467], 495: [1323, 1207], 157: [315], 716: [386, 904], 467: [443], 1323: [1243], 1214: [1371], 1243: [423, 249, 953], 443: [1409, 215], 1371: [1462, 1307], 423: [1222, 937], 386: [226], 904: [226], 315: [732], 1409: [1396], 953: [1337, 268, 937], 249: [57, 268], 1222: [445], 215: [569], 226: [934], 1396: [1442], 934: [71, 187], 268: [624], 1462: [655], 1337: [849], 937: [849, 1280], 1442: [70, 499, 1456], 1280: [115], 569: [392], 71: [1162, 58, 1333], 849: [1254, 96], 624: [1459], 1459: [1217], 392: [1356], 1162: [201, 1474], 70: [335], 445: [1333], 187: [113, 1161], 115: [512], 1356: [818], 1217: [98], 1456: [448, 767], 818: [691], 201: [855], 767: [134, 408, 688], 113: [236, 680], 98: [350, 748], 691: [1297, 1022], 335: [1412, 408], 1333: [1474], 448: [464], 350: [780], 1474: [1362], 96: [1397], 1397: [182, 890], 1362: [604], 1161: [680], 499: [688], 464: [1028, 210], 680: [47, 221], 688: [355], 855: [1020], 1022: [1321], 780: [590], 47: [381], 890: [698], 604: [1021], 1412: [1173], 1021: [949, 220], 210: [1172, 192], 1173: [19], 381: [26], 1172: [109, 1453], 221: [465, 160], 698: [491, 528], 1028: [192], 26: [1159], 528: [538, 1153], 19: [1005], 160: [142, 830, 197], 1005: [794, 1050], 949: [1071], 538: [1071, 903], 491: [1237], 794: [119, 35], 1237: [419, 643], 1159: [621], 419: [777], 1153: [903], 830: [1211], 119: [34], 777: [168], 197: [574, 846], 1050: [1002], 109: [138], 1453: [138], 1211: [365, 1045, 1341], 846: [679, 1170], 34: [1213], 35: [1242, 897], 1071: [1443], 903: [1443, 947], 643: [2], 192: [287], 1213: [559], 465: [1341], 1045: [8], 287: [500, 367], 1443: [881, 819], 168: [909], 365: [166, 850], 897: [451], 1341: [850], 1242: [957, 1010], 1002: [1076], 574: [1305], 451: [230], 957: [230, 639], 1010: [230, 473, 1433], 679: [864], 166: [924], 1170: [947], 850: [1346], 230: [990, 199], 367: [1291], 864: [1291, 704], 909: [208], 1305: [208], 639: [199, 336], 473: [259, 610], 208: [374, 524], 1291: [506, 877], 506: [108, 1226], 819: [1358], 374: [83], 199: [416], 877: [498], 610: [975], 336: [1083], 1358: [1454], 1226: [738], 975: [1075, 347], 416: [240], 498: [845, 770], 1083: [931, 940], 1075: [1134, 12], 738: [653, 1073], 1454: [889], 259: [1463], 931: [353, 530, 1257], 1433: [456], 240: [1257], 770: [1401], 353: [418], 530: [822], 1257: [1178], 1401: [544], 822: [1359], 1134: [683], 347: [1389, 576], 1178: [178], 1359: [532, 861], 544: [823], 1389: [1171], 1171: [146, 561, 1188], 823: [1440], 178: [25, 1100], 532: [43, 534, 735], 25: [167, 474], 1440: [1053, 1405], 43: [1388, 515, 981], 146: [28], 1388: [615, 618], 861: [618], 1053: [737], 1100: [807], 167: [939], 534: [1302], 515: [1065], 737: [213], 1302: [717, 1348], 474: [1426], 618: [1477], 1348: [470], 717: [762, 382], 470: [1057, 1199, 1354], 1354: [42, 340], 382: [820, 1164], 1057: [857], 1199: [857], 42: [1284], 857: [81], 1164: [503], 820: [689], 340: [1296], 1284: [1351], 81: [1062], 1296: [727], 689: [1391], 727: [504], 1351: [601], 1062: [6], 601: [242, 401, 887], 504: [366, 869, 390, 1273], 6: [477, 952], 366: [648, 120], 869: [74], 390: [74], 1273: [536], 887: [945], 242: [405], 74: [892], 536: [892, 458], 648: [1329], 405: [895, 399, 1218], 945: [1480], 895: [31, 609], 1329: [540], 31: [298, 979, 1411], 1480: [466], 458: [308, 920], 399: [1128], 540: [1415], 466: [313], 298: [1190], 609: [1192, 1411], 1415: [1334], 313: [364, 1085], 920: [964], 979: [744], 364: [1125], 1125: [1157, 577], 964: [1234], 744: [396], 1085: [652], 652: [228, 422], 396: [295], 1234: [318], 1157: [480], 228: [899], 577: [253, 1185], 480: [1092, 1024], 899: [1357, 839], 422: [1393, 14], 318: [1475], 1092: [5], 839: [1012, 627], 1012: [148], 1475: [566, 183, 1276], 1357: [1006], 253: [1001], 1024: [1084], 295: [1276], 5: [1317, 490], 1084: [252, 413, 672], 1317: [1425, 922], 1425: [129], 1276: [169, 814, 1392], 148: [697], 183: [699], 566: [814], 814: [112, 121], 1006: [686], 129: [1112, 893, 1399], 699: [39], 686: [133, 563], 121: [189], 252: [299], 697: [1201], 112: [285, 400], 39: [342], 1392: [627], 893: [1313], 133: [637, 22], 299: [834], 1112: [1080], 285: [1381], 342: [1381], 413: [658], 672: [658], 490: [658, 922], 563: [1180], 1201: [1186, 511], 189: [1404, 1158], 627: [501], 922: [427], 834: [826, 1179, 493, 546], 637: [1431, 722], 22: [1431, 511, 722], 658: [1151], 501: [1158], 1179: [1347], 1431: [140, 787], 722: [436, 1322], 1151: [764, 913], 427: [1038], 1399: [700], 826: [817], 1347: [1098, 1461], 764: [1301], 1098: [9, 391], 1461: [9, 746], 511: [147], 787: [630], 817: [874], 630: [92, 460], 913: [284], 1038: [507], 700: [564], 1186: [27], 1301: [476], 564: [900], 147: [991], 507: [181], 27: [432, 62], 284: [433], 9: [468], 991: [125, 746], 468: [277], 546: [659], 432: [885], 92: [17], 476: [76], 493: [702], 391: [938, 1255], 900: [1266], 181: [1470], 1266: [695, 1325], 885: [983], 695: [1025, 265], 62: [102], 983: [114, 290, 1330], 1325: [265, 863], 702: [404], 17: [434], 1470: [788], 1025: [116, 608], 434: [1167], 114: [282, 334, 159], 290: [334, 447, 739], 1167: [428], 116: [484], 788: [565], 277: [1023], 404: [1239], 428: [925], 1239: [1009], 484: [1142, 107], 863: [1165, 286], 1023: [1378, 815], 608: [90], 1330: [792], 565: [1181], 1378: [29, 312], 1181: [516, 286], 282: [553], 90: [616, 831], 1009: [1039], 159: [1448], 1039: [161, 1398], 792: [373, 836], 107: [455], 616: [1250, 279], 29: [82, 662], 739: [132], 831: [279], 1448: [312], 373: [1126], 836: [234], 312: [384, 1079, 1138], 815: [660, 1070], 1250: [1235], 553: [1379], 1070: [145, 650], 384: [791], 1079: [973], 1235: [1419], 279: [1464], 973: [1407, 1368, 1063], 1464: [690, 135], 234: [798], 662: [801], 1419: [1069], 798: [51, 122], 650: [333, 278], 122: [1272, 38], 690: [1298], 1069: [1318], 1298: [713], 51: [996], 278: [1414, 1263], 1414: [7], 1318: [1274, 674], 38: [176], 1272: [276], 276: [56], 176: [471, 329, 1013], 1263: [1316], 56: [272, 263], 1274: [1095], 1316: [84, 755], 329: [106, 1064], 674: [1091], 84: [21], 106: [88], 263: [824], 1064: [244, 153], 88: [123], 244: [1269, 758], 123: [245], 21: [578], 1269: [872], 153: [1034], 872: [763, 482], 763: [1268], 1268: [222, 394], 222: [595, 696], 394: [595, 696], 595: [1]}
        intersections_down = {944: [403], 1299: [1324], 380: [1230, 369], 454: [359, 1308, 705], 723: [417], 1060: [369], 1311: [1113], 1466: [1163], 358: [1299], 711: [771, 1113], 1403: [1060], 407: [358], 412: [1113], 708: [723], 956: [944], 1292: [1113], 233: [407], 772: [711], 1099: [454], 1395: [380], 1435: [412], 250: [407], 338: [233], 479: [1435], 753: [708], 919: [1099], 1087: [1395], 1096: [711], 1114: [1403], 1224: [956], 104: [233], 172: [479], 232: [597], 266: [1114], 311: [1311, 711, 412], 341: [1099], 729: [708], 929: [407], 1029: [1087], 1245: [753], 867: [929, 1029], 1176: [1224], 40: [311], 325: [479], 354: [1224], 439: [1087], 1252: [1096], 79: [311], 327: [232], 339: [232], 789: [311], 813: [1176], 902: [729], 923: [172], 36: [772], 154: [1252], 492: [354], 1364: [327], 46: [439], 170: [354], 173: [354], 212: [40], 248: [79], 733: [339], 954: [867], 1204: [492], 1343: [40], 209: [36], 319: [170], 357: [248], 581: [923], 1000: [1364], 548: [212], 960: [36], 998: [954], 1048: [209], 131: [209], 185: [867, 46], 291: [36], 602: [248], 987: [960], 1320: [248], 3: [867, 46, 602], 989: [185], 1011: [1000], 1196: [998], 1275: [998], 1314: [987], 130: [954, 3], 195: [1320], 440: [1314], 592: [1011], 1168: [291], 1336: [1048], 256: [3], 475: [1314, 1336], 880: [1011], 948: [130], 1319: [1275], 1420: [130], 16: [592], 97: [1196, 1319], 246: [1420], 673: [592], 1026: [1275], 1383: [880], 1408: [998, 989, 256], 346: [246], 406: [880], 1056: [440], 32: [673], 77: [1408], 461: [475, 406], 906: [1319], 918: [673], 959: [16], 1116: [948], 1240: [1056], 1366: [673], 124: [1366], 649: [959], 799: [1240], 961: [1116], 1436: [1383], 1446: [1026], 10: [918, 1366], 1078: [97, 906], 1278: [1436], 103: [799], 207: [124, 649, 10], 703: [1436], 742: [959], 1338: [1240], 453: [1078], 526: [1338], 631: [742], 747: [1338], 752: [1278], 978: [906, 1446], 238: [1278], 718: [752], 879: [77], 974: [747], 1227: [124, 703], 424: [718], 444: [453], 570: [1078, 978], 1264: [526, 747], 11: [961], 85: [1227], 111: [631], 267: [1227], 894: [879], 1052: [207], 1155: [1264], 198: [424], 701: [1264], 812: [974], 930: [974], 1360: [11], 1467: [974], 667: [267, 1052], 675: [1467], 833: [701], 865: [894], 871: [1155], 942: [570], 1007: [111], 94: [85], 402: [894], 783: [267], 941: [667, 1007], 1030: [675], 1460: [11], 337: [1052], 768: [930], 1036: [198], 61: [783], 810: [871], 1216: [402], 1247: [871], 1306: [337], 1361: [941], 1365: [941], 344: [1306], 505: [337], 816: [1216], 395: [1216], 821: [1361], 1121: [768], 531: [1306], 907: [1216], 1068: [821], 1127: [1247], 1349: [1460], 843: [816], 1044: [907], 1312: [1127], 66: [1068], 606: [843], 935: [1312], 281: [1349], 537: [843], 994: [1312], 1146: [1247], 1198: [843], 1262: [1361, 1365, 531], 398: [1198], 549: [843], 1187: [994], 55: [66], 300: [1187], 481: [281], 634: [606, 1262], 682: [606], 825: [1146], 1049: [66], 139: [1049], 314: [634], 420: [1049], 607: [549], 775: [281], 898: [634], 1382: [549], 59: [682], 640: [898], 985: [481], 734: [775], 888: [139], 1244: [1382], 1304: [314], 1377: [55], 177: [888], 270: [1304], 305: [1244], 1309: [898, 59], 1400: [898], 463: [305], 1469: [177], 483: [1309], 709: [734], 1212: [1304], 4: [305, 1400], 127: [305], 778: [1469], 873: [177], 1246: [1469], 1286: [1309], 1444: [463], 190: [778, 1246], 437: [709], 884: [873], 1058: [1286], 529: [127], 603: [270], 628: [709], 1147: [437], 1485: [437], 80: [1147], 317: [4], 330: [778, 1246], 870: [1485], 304: [1058], 910: [870], 258: [330], 414: [317], 583: [80], 661: [529], 1110: [80], 1132: [1485], 1380: [1147], 99: [190, 330], 293: [1132], 692: [910], 1427: [661], 68: [692], 219: [910], 255: [99], 502: [304], 719: [661], 970: [293], 1074: [1427], 1169: [583], 1287: [293], 1342: [293], 93: [68], 485: [255], 651: [258], 915: [258], 950: [970], 955: [68], 966: [1132, 1380], 1067: [692], 75: [970], 149: [502], 191: [970, 1342], 397: [1074], 859: [1169], 1182: [1169], 1373: [99], 1387: [502], 117: [1110], 450: [1287], 472: [1182], 666: [1067], 1375: [955], 1406: [1182], 1471: [1169], 128: [191], 193: [1182], 513: [472, 1406], 656: [692, 1342], 760: [1182], 1043: [859], 1455: [1182], 306: [397], 710: [1471], 1105: [472], 1352: [450], 1410: [1387], 489: [1455], 800: [117], 984: [193], 105: [710], 174: [193], 348: [656], 363: [485, 1105], 411: [800], 806: [656], 848: [128], 1184: [513], 379: [1105], 749: [306], 1145: [1352], 310: [411], 486: [1375], 669: [1043], 1014: [984], 1027: [379], 60: [806], 202: [105], 376: [174], 914: [749], 1340: [666], 241: [202], 488: [379], 547: [310], 614: [486], 72: [1340], 429: [1014], 968: [310], 1150: [486], 1303: [1340], 1473: [547], 636: [914], 726: [429], 784: [1027, 429], 951: [72], 50: [429], 361: [241], 1253: [636], 214: [361], 431: [1473], 795: [50], 1061: [726], 1148: [1303], 1236: [784], 1249: [636], 1439: [784], 462: [951], 613: [951], 750: [431], 962: [951], 969: [50], 1206: [1439], 835: [795, 969], 1086: [795], 1203: [962], 49: [1148, 462, 962], 321: [1206], 435: [795], 514: [969], 740: [1249], 986: [968, 969], 1088: [1203], 1327: [613], 1376: [1086], 521: [1327], 946: [1327], 1115: [1327], 1441: [321], 1450: [435], 179: [521], 288: [946], 982: [986], 200: [179], 743: [1450], 785: [1441], 316: [288], 730: [200], 1345: [750, 1441], 1372: [743], 1458: [982], 275: [179], 1120: [1372], 1130: [1372], 1141: [316], 1449: [200], 446: [1458], 844: [1120], 1041: [200], 1457: [743], 345: [1457], 425: [446], 552: [1449], 646: [1041], 933: [1449], 992: [1457], 1193: [730], 442: [844], 573: [1457], 868: [1141], 1231: [275], 261: [1231], 560: [573], 797: [1231], 905: [868], 1152: [552], 1310: [442], 1417: [425], 13: [345, 992], 289: [933], 292: [425], 882: [1152], 1032: [1130, 992], 1118: [1231], 73: [868], 164: [13], 332: [1118], 1017: [1032], 1089: [868], 1135: [1152], 517: [1310], 523: [1152], 676: [1310], 841: [1417], 943: [13], 1040: [560], 1468: [1417], 203: [517], 588: [841], 808: [1089], 1195: [882], 1478: [1118], 307: [1478], 555: [517, 676], 757: [808], 774: [1135], 1140: [73], 1143: [1135], 1484: [943], 144: [1140], 741: [774], 988: [203, 1143], 1144: [1484], 1476: [1468], 126: [1478], 296: [757], 625: [741], 1004: [1476], 1136: [144], 756: [296], 54: [756], 262: [144], 368: [988], 1124: [1476], 1282: [741], 1288: [1004], 1428: [741], 594: [1004], 1139: [1004], 1355: [1428], 1451: [1124], 175: [594], 224: [368], 542: [296, 262], 1208: [1139], 1293: [1124], 143: [307], 162: [368], 247: [126], 510: [1428], 1051: [542], 1160: [1293], 52: [625, 542], 487: [247], 593: [224, 162], 908: [510], 1315: [247], 194: [1208], 518: [143], 557: [52], 589: [175], 731: [1355, 510], 1093: [175], 362: [557], 759: [224, 162], 995: [52], 1037: [1051], 1328: [487], 1402: [518], 223: [1328], 1082: [593], 1122: [143], 1137: [995], 1363: [593], 1481: [1328], 572: [1137], 714: [1402], 804: [1082], 89: [1402], 1251: [1137], 1434: [1122], 1220: [1251], 158: [223], 260: [1251], 605: [714], 509: [260], 519: [1220], 543: [260], 769: [158], 556: [519, 543], 598: [605], 1416: [543], 136: [158], 184: [598], 600: [605], 976: [158], 1335: [509], 86: [1335], 1202: [1416], 1248: [543], 188: [184], 410: [136], 551: [184], 641: [1335], 1018: [598], 1386: [136], 23: [976], 137: [188], 323: [86], 383: [136], 541: [556, 1335], 665: [1386], 685: [1248], 1066: [551], 1300: [184, 1018], 331: [685], 671: [1300], 773: [410], 878: [685], 1003: [86], 1289: [551], 1418: [410], 229: [773], 274: [137], 539: [383], 687: [685], 927: [323], 1090: [1066], 1109: [1066], 971: [1289], 1200: [410, 23], 1223: [331], 1228: [878], 141: [773], 582: [671], 619: [1109], 693: [927], 838: [274], 1166: [687], 225: [971], 793: [1223], 1331: [141], 1432: [838], 45: [1166], 497: [1223], 580: [1228], 852: [693], 891: [1432], 48: [1331], 343: [891], 469: [582], 591: [1166], 654: [497], 765: [45], 1154: [551], 1283: [45], 64: [225], 478: [793, 497], 535: [852], 681: [1154], 707: [1090, 971], 1437: [1154], 204: [64], 254: [891], 926: [1437], 1285: [1283], 100: [765], 205: [591], 724: [343], 754: [64], 811: [681], 1054: [654], 1413: [204], 151: [681], 216: [478], 790: [1109, 681], 1374: [724], 1385: [478], 283: [1385], 829: [1285], 1175: [811], 1339: [790], 239: [225], 269: [151], 459: [254], 832: [1054, 1385], 876: [239], 896: [1413], 1117: [239], 736: [829], 751: [283, 239], 273: [1117], 352: [736], 377: [736], 664: [736], 678: [736], 721: [273], 156: [751], 761: [751], 1350: [751], 712: [377], 862: [664], 911: [273], 1267: [156], 1281: [721], 527: [1281], 632: [678], 782: [1267], 847: [721], 997: [1267], 1133: [911], 584: [782], 596: [782], 1102: [1133], 297: [911], 567: [632], 620: [847], 901: [596], 1104: [632], 1123: [862], 1194: [596], 360: [567], 494: [1133], 562: [997], 231: [360], 349: [297], 668: [1123], 779: [360], 856: [901], 18: [527], 645: [856], 670: [1104], 1094: [620], 63: [562], 421: [562], 1046: [645], 1111: [856], 1465: [779], 617: [668], 766: [494, 349], 802: [1094], 958: [231], 1019: [1111], 1229: [1094], 33: [1094], 370: [421, 617], 388: [1465], 980: [18], 1055: [645], 171: [1229], 180: [1229, 33], 196: [370], 644: [1229], 837: [421], 1259: [63], 44: [171, 180], 853: [388], 999: [980], 1016: [766], 1103: [958], 1233: [370], 78: [644], 118: [180], 294: [802, 33], 387: [196], 633: [980], 1008: [837], 1260: [644], 15: [78, 1260], 150: [853], 152: [1260], 426: [78], 1035: [837, 1259], 1215: [196, 1233], 211: [44], 457: [1008, 1035], 1047: [15, 152], 1129: [152], 1295: [1103], 67: [294, 457], 623: [152], 1258: [1047], 30: [633], 371: [1129], 385: [1215], 415: [1035], 657: [211], 684: [150], 235: [999], 586: [415], 663: [684], 866: [657], 1384: [657], 809: [1258, 1384], 916: [415], 496: [809], 917: [415], 921: [235], 1072: [235], 24: [1258, 371], 302: [866], 328: [586], 554: [916], 1077: [866], 1367: [921], 1369: [663], 1472: [921], 599: [554], 776: [980, 916], 803: [1077], 1108: [1077], 1197: [328], 1241: [1369], 1430: [809], 186: [1197], 257: [803], 550: [1072], 568: [1108], 860: [776], 965: [302], 972: [776], 1210: [599], 1332: [1472], 65: [550], 356: [972], 642: [302], 1119: [1430], 1261: [554], 237: [496, 1430, 965], 320: [257], 393: [356], 854: [1197], 1177: [803, 965], 227: [320], 409: [1332], 715: [972], 1183: [1332], 1370: [550], 1423: [965, 642], 1479: [186], 647: [715], 720: [65], 886: [1423], 1059: [237], 1353: [1261], 264: [24, 393], 1107: [1370], 1225: [1059], 206: [1183], 280: [1183], 828: [264], 301: [1370], 324: [1367], 438: [1059], 840: [1353], 69: [264], 95: [324], 558: [1423, 828], 706: [720], 842: [706], 936: [95], 977: [1107, 301], 1344: [828, 69], 1422: [280], 375: [977], 611: [706], 1015: [706], 1483: [438], 351: [95], 378: [1015], 545: [1422], 585: [842], 725: [568, 69], 1033: [558, 1344], 53: [977], 218: [611], 571: [545], 575: [1344], 875: [351], 1238: [936], 622: [351], 694: [1033], 1131: [1015], 303: [694], 587: [1238], 786: [694], 1174: [378], 1270: [351], 1394: [1131], 1447: [622], 87: [218], 635: [875], 745: [375], 1256: [1238], 1429: [375], 271: [694], 912: [587, 1256], 1106: [622], 37: [53], 449: [1394], 525: [1429], 805: [587, 1256], 827: [1174], 1221: [1394], 1277: [1270], 1279: [1106], 322: [635], 579: [635], 728: [449], 932: [449], 1265: [87], 1390: [1279], 1438: [912], 110: [1221], 243: [37], 851: [322], 967: [1390], 1294: [728], 41: [967], 165: [932], 677: [1447, 1277], 1326: [1265], 1421: [805], 1445: [1221], 251: [110], 430: [1326], 533: [851], 1101: [1421], 1156: [1438, 1421], 1482: [1294], 522: [1482], 796: [41], 1042: [1326], 1232: [1421], 1271: [677], 1290: [1482], 20: [1290], 163: [522], 372: [1042], 626: [533], 781: [1271], 1031: [243], 441: [20], 508: [1232], 520: [626], 928: [1031], 629: [372], 155: [626], 963: [1042], 993: [110], 1081: [1031], 1097: [372], 389: [1097], 883: [963], 1149: [796], 1191: [993], 452: [883], 1452: [1097], 326: [155], 495: [993], 858: [1097], 1219: [883], 1189: [1191], 1209: [452], 1214: [858], 157: [1209], 716: [858], 1323: [495], 467: [1209], 1207: [1191, 495], 315: [157], 386: [716], 443: [467], 1243: [1323], 1371: [1214], 423: [1243], 904: [716], 1409: [443], 1462: [1371], 215: [443], 249: [1243], 1222: [423], 1307: [1371], 226: [386, 904], 732: [315], 953: [1243], 1396: [1409], 1337: [953], 57: [249], 268: [249, 953], 445: [1222], 569: [215], 937: [423, 953], 934: [226], 1442: [1396], 71: [934], 624: [268], 655: [1462], 849: [1337, 937], 1280: [937], 70: [1442], 115: [1280], 392: [569], 499: [1442], 1162: [71], 1254: [849], 1459: [624], 96: [849], 187: [934], 1217: [1459], 1356: [392], 58: [71], 201: [1162], 335: [70], 1333: [445, 71], 1456: [1442], 113: [187], 512: [115], 818: [1356], 98: [1217], 448: [1456], 691: [818], 767: [1456], 855: [201], 1161: [187], 134: [767], 236: [113], 350: [98], 1297: [691], 1412: [335], 1474: [1162, 1333], 408: [335, 767], 464: [448], 748: [98], 780: [350], 1362: [1474], 1397: [96], 182: [1397], 604: [1362], 680: [113, 1161], 688: [499, 767], 890: [1397], 1022: [691], 1028: [464], 47: [680], 355: [688], 1020: [855], 1321: [1022], 590: [780], 210: [464], 221: [680], 381: [47], 698: [890], 1021: [604], 1173: [1412], 949: [1021], 1172: [210], 19: [1173], 26: [381], 109: [1172], 465: [221], 491: [698], 528: [698], 160: [221], 192: [1028, 210], 220: [1021], 1159: [26], 538: [528], 1005: [19], 142: [160], 794: [1005], 830: [160], 1071: [949, 538], 1153: [528], 1237: [491], 119: [794], 197: [160], 419: [1237], 1453: [1172], 35: [794], 621: [1159], 643: [1237], 777: [419], 903: [538, 1153], 1050: [1005], 1211: [830], 34: [119], 168: [777], 574: [197], 846: [197], 1002: [1050], 138: [109, 1453], 365: [1211], 679: [846], 1045: [1211], 1213: [34], 1242: [35], 1443: [1071, 903], 2: [643], 287: [192], 559: [1213], 897: [35], 1341: [465, 1211], 8: [1045], 500: [287], 881: [1443], 909: [168], 1170: [846], 166: [365], 367: [287], 451: [897], 819: [1443], 850: [365, 1341], 957: [1242], 1010: [1242], 1076: [1002], 1305: [574], 230: [451, 957, 1010], 864: [679], 924: [166], 947: [903, 1170], 1346: [850], 473: [1010], 639: [957], 990: [230], 1291: [367, 864], 208: [909, 1305], 199: [230, 639], 259: [473], 374: [208], 524: [208], 704: [864], 336: [639], 506: [1291], 610: [473], 877: [1291], 108: [506], 1358: [819], 83: [374], 416: [199], 1226: [506], 498: [877], 975: [610], 1083: [336], 1454: [1358], 738: [1226], 1075: [975], 240: [416], 845: [498], 931: [1083], 940: [1083], 1134: [1075], 1433: [1010], 653: [738], 770: [498], 889: [1454], 1463: [259], 12: [1075], 353: [931], 1073: [738], 456: [1433], 530: [931], 1257: [240, 931], 1401: [770], 418: [353], 822: [530], 1178: [1257], 347: [975], 544: [1401], 1359: [822], 683: [1134], 1389: [347], 178: [1178], 532: [1359], 576: [347], 823: [544], 1171: [1389], 146: [1171], 561: [1171], 861: [1359], 1440: [823], 25: [178], 43: [532], 534: [532], 735: [532], 1188: [1171], 167: [25], 1053: [1440], 1100: [178], 1388: [43], 28: [146], 515: [43], 615: [1388], 618: [861, 1388], 737: [1053], 807: [1100], 939: [167], 981: [43], 1302: [534], 1405: [1440], 474: [25], 1065: [515], 213: [737], 717: [1302], 1348: [1302], 1426: [474], 1477: [618], 470: [1348], 762: [717], 382: [717], 1057: [470], 1199: [470], 1354: [470], 42: [1354], 820: [382], 857: [1057, 1199], 1164: [382], 340: [1354], 1284: [42], 81: [857], 503: [1164], 689: [820], 1296: [340], 1351: [1284], 1062: [81], 727: [1296], 1391: [689], 504: [727], 601: [1351], 6: [1062], 242: [601], 366: [504], 401: [601], 477: [6], 869: [504], 952: [6], 390: [504], 648: [366], 887: [601], 1273: [504], 74: [869, 390], 120: [366], 536: [1273], 945: [887], 405: [242], 892: [74, 536], 1329: [648], 895: [405], 1480: [945], 31: [895], 458: [536], 540: [1329], 399: [405], 1218: [405], 298: [31], 466: [1480], 609: [895], 308: [458], 920: [458], 1128: [399], 1415: [540], 313: [466], 979: [31], 1190: [298], 1192: [609], 1334: [1415], 364: [313], 1411: [31, 609], 964: [920], 744: [979], 1085: [313], 1125: [364], 1157: [1125], 1234: [964], 396: [744], 577: [1125], 652: [1085], 228: [652], 295: [396], 318: [1234], 480: [1157], 899: [228], 253: [577], 422: [652], 1092: [480], 1185: [577], 1357: [899], 1393: [422], 14: [422], 839: [899], 1024: [480], 1475: [318], 5: [1092], 1012: [839], 148: [1012], 566: [1475], 1006: [1357], 183: [1475], 1001: [253], 1084: [1024], 1276: [295, 1475], 1317: [5], 252: [1084], 1425: [1317], 129: [1425], 169: [1276], 697: [148], 699: [183], 814: [566, 1276], 112: [814], 121: [814], 413: [1084], 672: [1084], 686: [1006], 1112: [129], 1392: [1276], 39: [699], 133: [686], 189: [121], 299: [252], 893: [129], 1201: [697], 285: [112], 342: [39], 490: [5], 627: [839, 1392], 1313: [893], 400: [112], 563: [686], 637: [133], 834: [299], 1080: [1112], 1381: [285, 342], 22: [133], 658: [413, 672, 490], 1180: [563], 1186: [1201], 1404: [189], 501: [627], 922: [1317, 490], 427: [922], 826: [834], 1179: [834], 1431: [637, 22], 511: [1201, 22], 722: [637, 22], 1151: [658], 1158: [189, 501], 1347: [1179], 1399: [129], 140: [1431], 436: [722], 764: [1151], 787: [1431], 1038: [427], 700: [1399], 817: [826], 1098: [1347], 1301: [764], 1322: [722], 1461: [1347], 9: [1098, 1461], 147: [511], 630: [787], 874: [817], 913: [1151], 92: [630], 284: [913], 507: [1038], 564: [700], 27: [1186], 391: [1098], 476: [1301], 900: [564], 991: [147], 181: [507], 432: [27], 433: [284], 460: [630], 468: [9], 493: [834], 546: [834], 125: [991], 277: [468], 659: [546], 885: [432], 17: [92], 62: [27], 76: [476], 702: [493], 746: [1461, 991], 938: [391], 1255: [391], 1266: [900], 1470: [181], 695: [1266], 983: [885], 1025: [695], 1325: [1266], 102: [62], 114: [983], 265: [695, 1325], 404: [702], 434: [17], 788: [1470], 116: [1025], 290: [983], 1167: [434], 1330: [983], 282: [114], 334: [114, 290], 428: [1167], 484: [116], 565: [788], 608: [1025], 863: [1325], 1023: [277], 1239: [404], 159: [114], 925: [428], 1009: [1239], 1142: [484], 1165: [863], 1378: [1023], 90: [608], 107: [484], 447: [290], 739: [290], 792: [1330], 1181: [565], 29: [1378], 516: [1181], 553: [282], 616: [90], 815: [1023], 831: [90], 1039: [1009], 1448: [159], 161: [1039], 286: [863, 1181], 373: [792], 455: [107], 1250: [616], 1398: [1039], 82: [29], 132: [739], 279: [616, 831], 312: [1378, 1448], 836: [792], 1126: [373], 234: [836], 384: [312], 660: [815], 662: [29], 1070: [815], 1079: [312], 1138: [312], 1235: [1250], 1379: [553], 145: [1070], 791: [384], 973: [1079], 1419: [1235], 1464: [279], 1407: [973], 650: [1070], 690: [1464], 798: [234], 801: [662], 1069: [1419], 1368: [973], 51: [798], 122: [798], 135: [1464], 333: [650], 1063: [973], 278: [650], 1272: [122], 1298: [690], 1318: [1069], 38: [122], 713: [1298], 996: [51], 1414: [278], 7: [1414], 1263: [278], 1274: [1318], 176: [38], 276: [1272], 674: [1318], 56: [276], 471: [176], 1316: [1263], 272: [56], 329: [176], 1095: [1274], 84: [1316], 106: [329], 1013: [176], 1091: [674], 263: [56], 755: [1316], 1064: [329], 21: [84], 88: [106], 824: [263], 244: [1064], 123: [88], 153: [1064], 1269: [244], 245: [123], 578: [21], 758: [244], 872: [1269], 1034: [153], 763: [872], 482: [872], 1268: [763], 222: [1268], 394: [1268], 595: [222, 394], 696: [222, 394], 1: [595]}


        # print(intersections_down)
        # print(intersections_up)

        total = 0
        for brick in data:
            x = self.remove_brick(brick[2], intersections_up, intersections_down)
            # print(x)
            total += x

        return total

    def load_handler_part1(self, data: [str]) -> [str]:
        points = []
        line_count = 1
        for line in data:
            cords = line.split('~')
            cord1 = [int(x) for x in cords[0].split(',')]
            cord2 = [int(x) for x  in cords[1].split(',')]
            if cord1[2] <= cord2[2]:
                points.append([cord1, cord2, line_count])
            else:
                points.append([cord2, cord1, line_count])
            line_count +=1
        points.sort(key=lambda c: c[0][2])
        return points

    def load_handler_part2(self, data: [str]) -> [str]:
        return self.load_handler_part1(data)



if __name__ == '__main__':
    configure()
    aoc = Aoc2023010()
    failed, results = aoc.run("part1x_[0-9]+.txt", "part2_[2-2]+.txt")
    if failed:
        sys.exit(1)
